kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
name: kaggle-agent

nodes:
  # Control plane node
  - role: control-plane
    kubeadmConfigPatches:
    - |
      kind: InitConfiguration
      nodeRegistration:
        kubeletExtraArgs:
          node-labels: "role=control-plane"
    extraPortMappings:
    - containerPort: 30080
      hostPort: 8080
      protocol: TCP
    - containerPort: 30090
      hostPort: 9090
      protocol: TCP
    - containerPort: 30300
      hostPort: 3000
      protocol: TCP
  
  # Worker nodes for system workloads
  - role: worker
    kubeadmConfigPatches:
    - |
      kind: JoinConfiguration
      nodeRegistration:
        kubeletExtraArgs:
          node-labels: "role=system"
    extraMounts:
    - hostPath: /Users/romil/Documents/kaggle-agent-k8's/storage
      containerPath: /mnt/kaggle-data
      readOnly: false
      selinuxRelabel: false
      propagation: None
  
  # Worker nodes for compute workloads
  - role: worker
    kubeadmConfigPatches:
    - |
      kind: JoinConfiguration
      nodeRegistration:
        kubeletExtraArgs:
          node-labels: "workload=kaggle-jobs"
    extraMounts:
    - hostPath: /Users/romil/Documents/kaggle-agent-k8's/storage
      containerPath: /mnt/kaggle-data
      readOnly: false
      selinuxRelabel: false
      propagation: None
  
  - role: worker
    kubeadmConfigPatches:
    - |
      kind: JoinConfiguration
      nodeRegistration:
        kubeletExtraArgs:
          node-labels: "workload=kaggle-jobs"
    extraMounts:
    - hostPath: /Users/romil/Documents/kaggle-agent-k8's/storage
      containerPath: /mnt/kaggle-data
      readOnly: false
      selinuxRelabel: false
      propagation: None

